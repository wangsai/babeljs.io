<!DOCTYPE html><html lang="en" class="no-js"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1"><title>Babili (babel-minify) · Babel</title><meta name="description" content="We released Babili as beta (0.0.1) a few days ago under an MIT license!"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/2/docsearch.min.css"><link rel="stylesheet" href="/css/main.css?t=2017-11-03T06:53:46+00:00"><link rel="canonical" href="https://babel.docschina.org//blog/2016/08/30/babili.html"><link rel="alternate" type="application/rss+xml" title="Babel" href="https://babel.docschina.org//feed.xml" /><link rel="icon" href="/favicon.ico" type="image/x-icon"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16"><link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><meta name="msapplication-TileColor" content="#da532c"><meta name="theme-color" content="#ffffff"><meta name="og:url" content="https://babeljs.io/"><meta name="og:image" content="website"><meta name="og:title" content="Babili (babel-minify) · Babel"><meta name="og:description" content="We released Babili as beta (0.0.1) a few days ago under an MIT license!"><meta name="og:image" content="https://babeljs.io/images/share-image.png"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:site" content="@babeljs"><meta name="twitter:title" content="Babili (babel-minify) · Babel"><meta name="twitter:description" content="We released Babili as beta (0.0.1) a few days ago under an MIT license!"><meta name="twitter:image:src" content="https://babeljs.io/images/share-image.png"><meta name="twitter:url" content="https://babel.docschina.org//blog/2016/08/30/babili.html"></head><input type="checkbox" id="babel-toggle-search" class="babel-toggle-search-checkbox" /><header class="navbar navbar-default navbar-fixed-top babel-nav" id="top" role="banner"><div class="container"> <a href="/" class="navbar-brand logo">Babel</a><div class="babel-navbar-toggles"><div class="navbar-header"> <button class="navbar-toggle collapsed" type="button" data-toggle="collapse" data-target="#babel-navbar" aria-controls="babel-navbar" aria-expanded="false"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar"></span> <span class="icon-bar"></span> <span class="icon-bar"></span> </button> <label for="babel-toggle-search" class="navbar-toggle babel-toggle-search-open"> <span class="sr-only">Open search</span> <span class="glyphicon glyphicon-search" aria-hidden="true"></span> </label></div></div><nav id="babel-navbar" class="collapse navbar-collapse babel-navbar"><ul class="nav navbar-nav"><li > <a href="/learn-es2015/">学习 ES2015</a></li><li class="dropdown "> <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">文档 <span class="caret"></span></a><ul class="dropdown-menu" role="menu"><li > <a href="/docs/setup/">配置</a></li><li > <a href="/docs/editors.html">编辑器</a></li><li > <a href="/docs/usage/caveats/">注意事项</a></li><li > <a href="/docs/community/videos/">视频</a></li><li class="group-name">相关依赖</li><li > <a href="/docs/core-packages/">babel-core</a></li><li > <a href="/docs/usage/polyfill/">babel-polyfill</a></li><li > <a href="/docs/plugins/">Plugins</a></li><li class="group-name">使用方式</li><li > <a href="/docs/usage/babelrc/">.babelrc</a></li><li > <a href="/docs/usage/cli/">babel-cli</a></li><li > <a href="/docs/usage/babel-register/">babel-register</a></li><li > <a href="/docs/usage/api/">API</a></li></ul></li><li > <a href="/repl/">试用</a></li><li class="active"> <a href="/blog/">Blog</a></li><li > <a href="/faq">常见问题</a></li><li > <a href="/team">团队</a></li><li class="dropdown "> <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">友情链接 <span class="caret"></span></a><ul class="dropdown-menu" role="menu"><li > <a href="https://docschina.org/">印记中文</a></li><li > <a href="https://vuefe.cn/">Vue.js 中文</a></li><li > <a href="https://doc.react-china.org/">React.js 中文</a></li><li > <a href="https://rollupjs.org/zh">rollup.js 中文</a></li><li > <a href="http://nodejs.cn/">Node.js 中文</a></li><li > <a href="https://doc.webpack-china.org/">webpack 中文</a></li></ul></li></ul><ul class="nav navbar-nav navbar-right nav-social"><li> <a href="https://opencollective.com/babel">赞助</a></li><li> <a href="https://discuss.babeljs.io">论坛</a></li><li> <a href="https://slack.babeljs.io/" title="Join us on Slack"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><rect x="219.27" y="221.3" width="72.04" height="69.58" transform="translate(-67.42 94.64) rotate(-18.52)"/><path d="M489.84,185.3C437,9.29,360.9-31.64,184.9,21.16S-32,150.1,20.76,326.1,149.7,543,325.7,490.24,542.64,361.3,489.84,185.3ZM401,299.5l-33.15,11.05,11.46,34.38c4.5,13.92-2.87,29.06-16.78,33.56-2.87.82-6.14,1.64-9,1.23a27.32,27.32,0,0,1-24.56-18l-11.46-34.38-68.36,22.92,11.46,34.38c4.5,13.92-2.87,29.06-16.78,33.56-2.87.82-6.14,1.64-9,1.23a27.32,27.32,0,0,1-24.56-18L198.81,367l-33.15,11.05c-2.87.82-6.14,1.64-9,1.23a27.32,27.32,0,0,1-24.56-18c-4.5-13.92,2.87-29.06,16.78-33.56L182,316.69l-22.1-65.9-33.15,11.05c-2.87.82-6.14,1.64-9,1.23a27.32,27.32,0,0,1-24.56-18C88.71,231.14,96.08,216,110,211.49l33.15-11.05-11.46-34.38c-4.5-13.92,2.87-29.06,16.78-33.56s29.06,2.87,33.56,16.78l11.46,34.38,68.36-22.92-11.46-34.38c-4.5-13.92,2.87-29.06,16.78-33.56s29.06,2.87,33.56,16.78L312.2,144l33.15-11.05c13.92-4.5,29.06,2.87,33.56,16.78s-2.87,29.06-16.78,33.56L329,194.3l22.1,65.9,33.15-11.05c13.92-4.5,29.06,2.87,33.56,16.78S414.93,295,401,299.5Z" transform="translate(0.7 0.3)"/></svg> </a></li><li> <a href="https://twitter.com/babeljs" title="Follow us on Twitter"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 416.32"><title>twitter</title><path d="M160.83,464.16c193.2,0,298.92-160.22,298.92-298.92,0-4.51,0-9-.2-13.52A214,214,0,0,0,512,97.22a212.93,212.93,0,0,1-60.44,16.6,105.7,105.7,0,0,0,46.3-58.19A209,209,0,0,1,431.07,81a105.09,105.09,0,0,0-181.73,71.91,116.12,116.12,0,0,0,2.66,24c-87.28-4.3-164.73-46.3-216.56-109.82A105.48,105.48,0,0,0,68,207.44a106.27,106.27,0,0,1-47.53-13.11v1.43a105.28,105.28,0,0,0,84.21,103.06,105.67,105.67,0,0,1-47.33,1.84,105.06,105.06,0,0,0,98.14,72.94A210.72,210.72,0,0,1,25,418.68a202.17,202.17,0,0,1-25-1.43,298.85,298.85,0,0,0,160.83,46.92" transform="translate(0 -47.84)" fill="#010101"/></svg> </a></li><li> <a href="https://github.com/babel/babel" title="Contribute on GitHub"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 499.36"><path d="M256,6.32c-141.36,0-256,114.61-256,256,0,113.09,73.34,209,175.08,242.9,12.8,2.35,17.47-5.56,17.47-12.34,0-6.08-.22-22.18-.35-43.54C121,464.83,106,415,106,415c-11.64-29.57-28.42-37.45-28.42-37.45C54.31,361.71,79.31,362,79.31,362c25.69,1.81,39.21,26.38,39.21,26.38,22.84,39.12,59.92,27.82,74.5,21.27,2.33-16.54,8.94-27.82,16.25-34.22C152.43,369,92.67,347,92.67,248.94c0-27.95,10-50.8,26.35-68.69-2.63-6.48-11.42-32.5,2.51-67.75,0,0,21.49-6.88,70.4,26.24a242.65,242.65,0,0,1,128.18,0c48.87-33.13,70.33-26.24,70.33-26.24,14,35.25,5.18,61.27,2.55,67.75,16.41,17.9,26.31,40.75,26.31,68.69,0,98.35-59.85,120-116.88,126.32,9.19,7.9,17.38,23.53,17.38,47.41,0,34.22-.31,61.83-.31,70.23,0,6.85,4.61,14.81,17.6,12.31C438.72,471.29,512,375.4,512,262.34,512,120.94,397.37,6.32,256,6.32Z" transform="translate(0 -6.32)" fill="#191717" fill-rule="evenodd"/></svg> </a></li></ul><label for="babel-toggle-search" class="navbar-toggle babel-toggle-search-open"> <span class="sr-only">打开搜索</span> <span class="glyphicon glyphicon-search" aria-hidden="true"></span> </label><div class="navbar-form navbar-right babel-search" role="search"><div class="input-group"> <label class="sr-only" aria-label="Search" for="babel-search-input">搜索</label><div class="babel-search-input-wrapper"> <input type="text" class="form-control" id="babel-search-input" accesskey="s" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" placeholder="在文档中搜索..."> <label for="babel-toggle-search" class="babel-toggle-search-close"> <span class="sr-only">关闭搜索</span> <span class="glyphicon glyphicon-remove-circle" aria-hidden="true"></span> </label></div></div></div></nav></div></header><div class="docs-header"><div class="container"><div class="row"><div class="col-md-6 col-md-push-3 text-center"><h1>Babili (babel-minify)</h1></div></div></div></div><div class="container"><div class="row"><div class="col-md-8 col-md-push-2 babel-blog-content"><p class="small text-center text-muted">Posted Aug 30, 2016 by <a href="https://twitter.com/left_pad">Henry Zhu</a></p><p>We released <a href="https://github.com/babel/babili">Babili</a> as beta (0.0.1) a few days ago under an MIT license!</p><blockquote><p>Try it out in the Babel <a href="http://babeljs.io/repl/#?babili=true&amp;evaluate=false">REPL</a> and report any bugs or potential optimizations we can make! There’s also a <a href="https://babeljs.slack.com/messages/minify/">#minify</a> slack room!</p></blockquote><p>There are a lot of (valid) questions about why a new minifier is a good idea, so this post should help with that.</p><p>TL;DR: Babili can accept ES2015+ input, while current minifiers are mostly limited to ES5, requiring code to be transpiled before minification. This is becoming unncessary as people begin to ship ES2015 to clients. Babili is also modular/flexible (being a <a href="http://babeljs.io/docs/plugins/#presets">Babel preset</a> means it supports user plugins) and can be used as a preset or CLI tool. Babili will also be able to make ES2015+ specific optimizations.</p><h2 id="pronunciation">Pronunciation</h2><div class="language-bash highlighter-rouge"><pre class="highlight"><code><span class="c"># sounds like "bah billy" or "Babadi" (from DBZ)</span>
say Babili
</code></pre></div><p>Babili is Babylon in Akkadian.</p><blockquote><p>If you can’t remember the name, babel-minify works too (made <a href="https://github.com/babel/babili/issues/124">an issue</a> for the name).</p></blockquote><h2 id="why-minify">Why minify?</h2><p>At a basic level, <a href="https://en.wikipedia.org/wiki/Minification_(programming)">minification</a> removes unnecessary characters from a program without changing its functionality – things like comments, whitespace, newlines, and extra parentheses. Advanced minification may transform programs into smaller equivalents and remove redundant/unreachable code.</p><p>Minification is primarily useful for decreasing the size of the JavaScript payload sent from the server to the client: users will download less code to use your website. Advanced minification can also result in shorter parse time (less code to parse) and in some cases faster runtime (e.g. advanced optimizations like function inlining).</p><h2 id="current-minifiers">Current minifiers</h2><p>Tools such as <a href="https://github.com/mishoo/UglifyJS2">Uglify</a> don’t currently support targeting the latest version of ECMAScript (<a href="https://github.com/mishoo/UglifyJS2/issues/448">not yet</a>: <a href="https://github.com/mishoo/UglifyJS2/tree/harmony">harmony branch</a>).</p><p>We currently use tools like Babel to compile ES2015 code down to ES5 code to support older browsers. Then we use something like Uglify to cut down on the bundle size.</p><p>As browsers implement more ES2015 features and we drop support for older browser versions, there is a sliding window of the version of ECMAScript you write in and the target ECMAScript version you minify to. However since Uglify cannot parse ES2015+, you would still have to compile down to ES5 anyway.</p><h2 id="babili">Babili</h2><p>That’s where Babili comes in.</p><p>Babili is ES2015+ aware because it is built using the Babel toolchain. It is written as a set of Babel plugins, consumable with the <a href="https://github.com/babel/babili/tree/master/packages/babel-preset-babili"><code class="highlighter-rouge">babili</code> preset</a>.</p><h2 id="example">Example</h2><p>Say we’re targeting the latest versions of Chrome, Firefox, Edge, and Safari – all of which support <a href="http://babeljs.io/learn-es2015/#classes">ES2015 classes</a>. Then, compiling ES2015 classes to a constructor function and prototype methods (ES5) results in more code (and potentially loses any optimizations browsers might have for classes).</p><div class="language-js highlighter-rouge"><pre class="highlight"><code><span class="kr">class</span> <span class="nx">Mangler</span> <span class="p">{</span>
  <span class="nx">constructor</span><span class="p">(</span><span class="nx">program</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">program</span> <span class="o">=</span> <span class="nx">program</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>
<span class="c1">// need this since otherwise Mangler isn't used</span>
<span class="k">new</span> <span class="nx">Mangler</span><span class="p">();</span>
</code></pre></div><p>Before, we might run Babel to transpile <a href="http://babeljs.io/docs/plugins/transform-es2015-classes">the class into a function</a> and run Uglify on the compiled code to send to the browser.</p><div class="language-js highlighter-rouge"><pre class="highlight"><code><span class="c1">// ES2015 code -&gt; Babel -&gt; Uglify/Babili -&gt; Minified ES5 Code</span>
<span class="kd">var</span> <span class="nx">a</span><span class="o">=</span><span class="kd">function</span> <span class="nx">a</span><span class="p">(</span><span class="nx">b</span><span class="p">){</span><span class="nx">_classCallCheck</span><span class="p">(</span><span class="k">this</span><span class="p">,</span><span class="nx">a</span><span class="p">),</span><span class="k">this</span><span class="p">.</span><span class="nx">program</span><span class="o">=</span><span class="nx">b</span><span class="p">};</span><span class="nx">a</span><span class="p">();</span>
</code></pre></div><p>With Babili, you can just run the minifier which works on ES2015 code.</p><div class="language-js highlighter-rouge"><pre class="highlight"><code><span class="c1">// ES2015 code -&gt; Babili -&gt; Minified ES2015 Code</span>
<span class="kr">class</span> <span class="nx">a</span><span class="p">{</span><span class="nx">constructor</span><span class="p">(</span><span class="nx">b</span><span class="p">){</span><span class="k">this</span><span class="p">.</span><span class="nx">program</span><span class="o">=</span><span class="nx">b</span><span class="p">}}</span><span class="k">new</span> <span class="nx">a</span><span class="p">;</span>
</code></pre></div><p>Also it’s important to note that this isn’t specific to ES2015. Because Babel updates as ECMAScript updates (with <a href="http://babeljs.io/docs/plugins/#official-presets">ES2015, ES2016, and now ES2017</a>) and follows the proposal process for experimental features (with our <a href="http://babeljs.io/docs/plugins/#stage-x-experimental-presets">stage-x presets</a>), the minifier should be able to output whatever version of ECMAScript that is supported.</p><p>In the future, we might make use of the ES2015+ syntax information we have at compile time (e.g. we know that given function is an arrow function or that a given binding is block-scoped etc) to do advanced optimizations. And we can make use of the knowledge that we’re targeting an ES2015+ environment in creative ways.</p><p>We’re just getting started so let us know if you have any ideas!</p><h3 id="some-of-the-plugins"><a href="https://github.com/babel/babili#plugins-in-babel-preset-babili">Some of the Plugins</a></h3><p>To give an idea of some of the transforms:</p><p><a href="https://github.com/babel/babili/tree/master/packages/babel-plugin-minify-constant-folding">babel-plugin-minify-constant-folding</a>:</p><p>Tries to evaluate expressions and inline the result. For now only deals with numbers and strings.</p><div class="language-js highlighter-rouge"><pre class="highlight"><code><span class="mi">2</span> <span class="o">*</span> <span class="mi">3</span><span class="p">;</span>
<span class="s2">"b"</span> <span class="o">+</span> <span class="nx">a</span> <span class="o">+</span> <span class="s2">"c"</span> <span class="o">+</span> <span class="s2">"d"</span> <span class="o">+</span> <span class="nx">g</span> <span class="o">+</span> <span class="nx">z</span> <span class="o">+</span> <span class="s2">"f"</span> <span class="o">+</span> <span class="s2">"h"</span> <span class="o">+</span> <span class="s2">"z"</span>
</code></pre></div><div class="language-js highlighter-rouge"><pre class="highlight"><code><span class="mi">6</span><span class="p">;</span>
<span class="s2">"b"</span> <span class="o">+</span> <span class="nx">a</span> <span class="o">+</span> <span class="s2">"cd"</span> <span class="o">+</span> <span class="nx">g</span> <span class="o">+</span> <span class="nx">z</span> <span class="o">+</span> <span class="s2">"fhz"</span><span class="p">;</span>
</code></pre></div><p><a href="https://github.com/babel/babili/tree/master/packages/babel-plugin-minify-mangle-names">babel-plugin-minify-mangle-names</a>:</p><p>Context- and scope- aware variable renaming.</p><div class="language-js highlighter-rouge"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">globalVariableName</span> <span class="o">=</span> <span class="mi">42</span><span class="p">;</span>
<span class="kd">function</span> <span class="nx">foo</span><span class="p">()</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">longLocalVariableName</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">longLocalVariableName</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">longLocalVariableName</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div><div class="language-js highlighter-rouge"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">globalVariableName</span> <span class="o">=</span> <span class="mi">42</span><span class="p">;</span>
<span class="kd">function</span> <span class="nx">foo</span><span class="p">()</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">a</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">a</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">a</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div><h2 id="usage">Usage</h2><h3 id="babel-preset">Babel Preset</h3><p>If you already use Babel, you can just add the <a href="https://github.com/babel/babili#babel-preset"><code class="highlighter-rouge">babili</code></a> preset (<code class="highlighter-rouge">babel-preset-babili</code>) to your config.</p><p>You will want to enable this only in production, so use the <a href="http://babeljs.io/docs/usage/babelrc/#env-option">env option</a> which uses either <code class="highlighter-rouge">process.env.BABEL_ENV</code> or <code class="highlighter-rouge">process.env.NODE_ENV</code></p><div class="language-bash highlighter-rouge"><pre class="highlight"><code><span class="gp">$ </span>npm install babel-preset-babili --save-dev
</code></pre></div><div class="language-js highlighter-rouge"><pre class="highlight"><code><span class="c1">// previous .babelrc</span>
<span class="p">{</span> <span class="s2">"presets"</span><span class="err">:</span> <span class="p">[</span><span class="s2">"es2015"</span><span class="p">]</span> <span class="p">}</span>
<span class="c1">// .babelrc</span>
<span class="p">{</span>
  <span class="s2">"presets"</span><span class="err">:</span> <span class="p">[</span><span class="s2">"es2015"</span><span class="p">],</span>
  <span class="s2">"env"</span><span class="err">:</span> <span class="p">{</span>
    <span class="s2">"production"</span><span class="err">:</span> <span class="p">{</span>
      <span class="s2">"presets"</span><span class="err">:</span> <span class="p">[</span><span class="s2">"babili"</span><span class="p">]</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div><p>One issue with using Babili as a preset is that then Babili would only run per-file rather than on the whole bundle. Minification usually happens after bundling as with the “UglifyJsPlugin” in webpack. However, running it after bundling would lose the speed benefits (needs to be measured) of doing the transpiling/minification in the same step. Again, this is something we need to think about: how to intergrate or pass more information to the bundler.</p><h3 id="babili-cli">Babili CLI</h3><p>If you don’t use Babel, you can use our standalone CLI tool <a href="https://github.com/babel/babili#cli"><code class="highlighter-rouge">babili</code></a>. (Currently it’s just a wrapper for <code class="highlighter-rouge">babel-cli</code> + the preset). You could run this after transpiling (or not) in place of Uglify.</p><div class="language-bash highlighter-rouge"><pre class="highlight"><code><span class="gp">$ </span>npm install babili --save-dev
</code></pre></div><div class="language-bash highlighter-rouge"><pre class="highlight"><code><span class="gp">$ </span>babili src -d lib
<span class="c"># equivalent to</span>
<span class="c"># babel src -d lib --presets=babili --no-babelrc</span>
</code></pre></div><h3 id="webpack">Webpack</h3><p>You can just use the preset with <a href="https://github.com/babel/babel-loader"><code class="highlighter-rouge">babel-loader</code></a>.</p><div class="language-bash highlighter-rouge"><pre class="highlight"><code><span class="gp">$ </span>npm install babel-core babel-loader babel-preset-babili
</code></pre></div><div class="language-js highlighter-rouge"><pre class="highlight"><code><span class="nx">module</span><span class="err">:</span> <span class="p">{</span>
  <span class="nl">loaders</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="na">test</span><span class="p">:</span> <span class="sr">/</span><span class="se">\.</span><span class="sr">js$/</span><span class="p">,</span>
      <span class="na">loader</span><span class="p">:</span> <span class="s1">'babel'</span><span class="p">,</span>
      <span class="na">query</span><span class="p">:</span> <span class="p">{</span>
        <span class="na">presets</span><span class="p">:</span> <span class="p">[</span><span class="s1">'babili'</span><span class="p">]</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">]</span>
<span class="p">}</span>
</code></pre></div><p>Or use it seperately with the <a href="https://github.com/boopathi/babili-webpack-plugin">babili-webpack-plugin</a> (made by <a href="https://github.com/boopathi/">@boopathi</a>, who also works on Babili).</p><div class="language-bash highlighter-rouge"><pre class="highlight"><code><span class="gp">$ </span>npm install babili-webpack-plugin --save-dev
</code></pre></div><div class="language-js highlighter-rouge"><pre class="highlight"><code><span class="c1">// webpack.config.js</span>
<span class="kr">const</span> <span class="nx">BabiliPlugin</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">"babili-webpack-plugin"</span><span class="p">);</span>
<span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="p">{</span>
  <span class="na">entry</span><span class="p">:</span> <span class="c1">//...,</span>
  <span class="na">output</span><span class="p">:</span> <span class="c1">//...,</span>
  <span class="na">plugins</span><span class="p">:</span> <span class="p">[</span>
    <span class="k">new</span> <span class="nx">BabiliPlugin</span><span class="p">(</span><span class="nx">options</span><span class="p">)</span>
  <span class="p">]</span>
<span class="p">}</span>
</code></pre></div><p>We want to have a better story with integration with Webpack/bundlers in the near future! Also check out <a href="https://github.com/babel/babili/issues/100">#100</a>.</p><h2 id="proscons">Pros/Cons</h2><p><strong>Uglify Pros</strong></p><ul><li><p>No change to existing tooling if you are already minifying.</p></li><li><p>Battle-tested/production ready (it’s been around for years and has wide adoption (we are all using it)!</p></li><li><p>It’s super fast and outputs small code already.</p></li></ul><p><strong>Uglify Cons</strong></p><ul><li><p>Custom parser/tooling, so it’s difficult to output/minify ES2015+ and make changes.</p></li><li><p>Not modular, and currently no way to create own plugins/minification strategies outside of core.</p></li></ul><p><strong>Babili Pros:</strong></p><ul><li><p>ES2015+ aware (nothing special needs to be done because we can use the babylon parser) and Babel will update as standards/browsers update.</p></li><li><p>Uses the existing Babel toolchain, can consume as a Babel preset or standalone.</p></li><li><p>Potential for custom smart transforms for React/Flow, etc.</p></li><li><p>Could use Flow/Typescript annotations to enable advanced minification.</p></li><li>Each minification step can be split into its own plugin, and there’s plenty of options for customization. This makes it easier to contribute and to find/submit issues for specific problems. It also means that people can independently create their own experimental plugins before upstreaming them into core.<ul><li>For example: <a href="https://github.com/babel/babili/tree/master/packages/babel-plugin-transform-minify-booleans">this</a> just turns <code class="highlighter-rouge">true</code> into <code class="highlighter-rouge">!0</code> which is straightforward to write.</li></ul></li><li>Should be an easy transition if people are familiar with transpiling with Babel already.</li></ul><p><strong>Babili Cons:</strong></p><ul><li><p>We released it early, so there aren’t many users yet. Early adopters will have to deal with a tool that isn’t as battle-tested as Uglify at first.</p></li><li><p>Right now, the performance is worse/size is worse than Uglify on our benchmark tests. However, this is something we’ll be focusing on improving.</p></li></ul><p>TL;DR: Babili should be able to keep up with the ECMAScript standard as new features get added as well as target the environments you need to support. It has a lot of potential: it may not be as production-ready as Uglify at the moment since it was just released but as we continue to optimize with more users it should be more than capable.</p><h2 id="how-to-help">How to Help</h2><p><a href="https://twitter.com/amasad">Amjad</a> had been working on this project for a while but we decided to release it earlier as a beta to allow the community to test it out and both contribute through reporting bugs and patches.</p><p>It’s still early days for this project so there’s a lot to help out with! Our next priority is to make Babili more stable/robust for a 1.0.0 release.</p><p>We will be working to get it as fast and produce code sizes as small as Uglify/<a href="https://github.com/google/closure-compiler">Closure Compiler</a> in simple mode.</p><ul><li><strong>Testing on more codebases</strong>: This will help everyone greatly. Because a minifier runs on all code it has potential for a lot of edge cases/bugs not covered in our basic unit tests. Hopefully we can setup a way to report issues easily; now that the <a href="https://babeljs.io/repl/">repl</a> supports the minifier it should be easier to reproduce/link bugs. In the future we want options to enable specific plugins so we can pinpoint minimal reproduction steps.</li><li><strong>Project infrastructure/maintenance</strong>: We want to create more robust benchmarking, setup integration tests on popular open source projects (run the minifier, and then run all the project’s unit tests).</li><li><strong>Check the output</strong>: If something can be more simplified, it should be straightforward to create an issue and suggest a new transformation to an existing plugin or create a new one. We have the benefit of being modular so anyone can also make their own plugins and then we can figure out whether to include them in the core preset.</li></ul><p>Huge thanks to <a href="https://github.com/amasad">Amjad (@amasad)</a> for starting this project and Facebook for allowing us to release this under the Babel organization as an MIT licensed project! <a href="https://github.com/kittens">Sebastian (@kittens)</a> was obviously a big part of this given this wouldn’t have been possible without Babel. Also thanks to <a href="https://github.com/thejameskyle">James (@thejameskyle)</a>, <a href="https://github.com/kangax">Juriy (@kangax)</a> for helping see this through to release! Also want to give a shoutout to <a href="https://github.com/boopathi">Boopathi (@boopathi)</a> who we invited to help us out after seeing the work on his own <a href="https://github.com/boopathi/babel-minify">babel-minify</a> project!</p><h2 id="community-discussion">Community Discussion</h2><div id="discourse-comments"></div><script type="text/javascript"> DiscourseEmbed = { discourseUrl: 'https://discuss.babeljs.io/', discourseEmbedUrl: 'https://babeljs.io/blog/2016/08/30/babili.html'}; (function() { var d = document.createElement('script'); d.type = 'text/javascript'; d.async = true; d.src = DiscourseEmbed.discourseUrl + 'javascripts/embed.js'; (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(d); })(); </script></div></div></div><div class="footer text-center"><p><a href="https://github.com/babel/babel">Babel</a> · <a href="https://github.com/babel/babel/blob/master/LICENSE">Distributed under MIT License</a> · <a href="https://github.com/babel/babel/blob/master/CODE_OF_CONDUCT.md">Code of Conduct</a></p><p><a href="http://henryzoo.com/babel.github.io/">Looking for Babel 5.x docs?</a> · Found an issue with the docs? Report it <a href="https://github.com/babel/babel.github.io/issues/new">here</a>.</p></div><script src='//cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js' defer></script> <script src='//cdnjs.cloudflare.com/ajax/libs/lodash.js/4.16.3/lodash.min.js' defer></script> <script src='//cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.1/js/bootstrap.min.js' defer></script> <script src='https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.5.13/clipboard.min.js' defer></script> <script src='https://cdn.jsdelivr.net/docsearch.js/2/docsearch.min.js' defer></script> <script src='/scripts/search.js' defer></script> <script src='/scripts/clipboard.js' defer></script> <script src='/scripts/open-in-repl.js' defer></script> <script> document.addEventListener('DOMContentLoaded', function() { $("html").removeClass("no-js").addClass("js"); }); </script></body></html>
